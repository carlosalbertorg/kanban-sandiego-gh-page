<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema para controle de tarefas</title>
    <link rel="stylesheet" href="css/style.css">
    
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
</head>
<body>
    <div id="loginContainer" class="login-container">
        <div class="login-box">
            <h1>üîê Sistema para Controle de Tarefas</h1>
            <p>Fa√ßa login para acessar o sistema</p>
            
            <form id="loginForm" onsubmit="login(event)">
                <div class="form-group">
                    <label for="loginEmail">Email:</label>
                    <input type="email" id="loginEmail" required placeholder="seu@email.com">
                </div>
                
                <div class="form-group">
                    <label for="loginPassword">Senha:</label>
                    <input type="password" id="loginPassword" required placeholder="Sua senha">
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="btn" style="width: 100%">Entrar</button>
                </div>
                
                <div id="loginError" class="error-message" style="display: none;"></div>
            </form>
            
            <div class="form-footer">
                <p><small>Entre em contato com o administrador para criar uma conta</small></p>
            </div>
        </div>
    </div>

    <div class="container" id="mainContainer">
        <div class="header">
            <h1>üöÄ Sistema de Gerenciamento de Projetos</h1>
            <p>Gest√£o completa de projetos, tarefas e equipes</p>
            <div class="user-info">
                <span class="user-email" id="userEmail"></span>
                <span class="role-badge" id="userRole"></span>
                <button class="btn-logout" id="userManagementBtn" style="display: none;" onclick="openUserManagement()">üë• Usu√°rios</button>
                <button class="btn-logout" onclick="logout()">Sair</button>
            </div>
            <div id="connectionStatus" class="status-indicator status-offline">
                <span class="loading" id="loadingIndicator"></span>
                Conectando ao banco de dados...
            </div>
        </div>
        
        <div class="tabs">
            <div class="tab active" onclick="switchTab('dashboard')">üìä Dashboard</div>
            <div class="tab" onclick="switchTab('projetos')">üìÅ Projetos</div>
            <div class="tab" onclick="switchTab('tarefas')">‚úÖ Tarefas</div>
            <div class="tab" onclick="switchTab('kanban')">üìã Kanban</div>
            <div class="tab" onclick="switchTab('gantt')">üìà Gantt</div>
            <div class="tab" onclick="switchTab('tempo')">‚è±Ô∏è Tempo</div>
        </div>
        
        <!-- Dashboard Tab -->
        <div id="dashboardTab" class="tab-content active">
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <h3>üìä Vis√£o Geral</h3>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <span class="stat-number" id="totalProjetos">0</span>
                            <span class="stat-label">Projetos Ativos</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number" id="totalTarefas">0</span>
                            <span class="stat-label">Tarefas</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number" id="tarefasPendentes">0</span>
                            <span class="stat-label">Pendentes</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number" id="tarefasConcluidas">0</span>
                            <span class="stat-label">Conclu√≠das</span>
                        </div>
                    </div>
                </div>
                
                <div class="dashboard-card">
                    <h3>‚è∞ Prazos Pr√≥ximos</h3>
                    <div id="proximosPrazos" class="prazos-list">
                        <!-- Tarefas com prazos pr√≥ximos ser√£o carregadas aqui -->
                    </div>
                </div>
                
                <div class="dashboard-card">
                    <h3>üë• Equipe</h3>
                    <div id="equipeStatus" class="equipe-grid">
                        <!-- Status da equipe ser√° carregado aqui -->
                    </div>
                </div>
                
                <div class="dashboard-card">
                    <h3>üìà Progresso dos Projetos</h3>
                    <div id="progressoProjetos" class="progresso-list">
                        <!-- Progresso dos projetos ser√° carregado aqui -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Projetos Tab -->
        <div id="projetosTab" class="tab-content">
            <div class="section-header">
                <h2>üìÅ Gerenciamento de Projetos</h2>
                <button class="btn btn-primary" onclick="openProjectModal()">‚ûï Novo Projeto</button>
            </div>
            
            <div class="projects-grid" id="projectsGrid">
                <!-- Projetos ser√£o carregados aqui -->
            </div>
        </div>

        <!-- Tarefas Tab -->
        <div id="tarefasTab" class="tab-content">
            <div class="section-header">
                <h2>‚úÖ Gerenciamento de Tarefas</h2>
                <div class="task-controls">
                    <select id="filterProject" onchange="filterTasks()">
                        <option value="">Todos os Projetos</option>
                    </select>
                    <select id="filterAssignee" onchange="filterTasks()">
                        <option value="">Todos os Respons√°veis</option>
                    </select>
                    <select id="filterStatus" onchange="filterTasks()">
                        <option value="">Todos os Status</option>
                        <option value="todo">A Fazer</option>
                        <option value="in-progress">Em Progresso</option>
                        <option value="review">Em Revis√£o</option>
                        <option value="done">Conclu√≠do</option>
                    </select>
                    <button class="btn btn-primary" onclick="openTaskModal()">‚ûï Nova Tarefa</button>
                </div>
            </div>
            
            <div class="tasks-table-container">
                <table class="tasks-table" id="tasksTable">
                    <thead>
                        <tr>
                            <th>Tarefa</th>
                            <th>Projeto</th>
                            <th>Respons√°vel</th>
                            <th>Status</th>
                            <th>Prioridade</th>
                            <th>Prazo</th>
                            <th>Progresso</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="tasksTableBody">
                        <!-- Tarefas ser√£o carregadas aqui -->
                    </tbody>
                </table>
            </div>
        </div>
        <!-- Kanban Tab -->
        <div id="kanbanTab" class="tab-content">
            <div class="section-header">
                <h2>üìã Quadro Kanban</h2>
                <div class="kanban-controls">
                    <select id="kanbanProjectFilter" onchange="filterKanban()">
                        <option value="">Todos os Projetos</option>
                    </select>
                    <button class="btn btn-primary" onclick="openTaskModal()">‚ûï Nova Tarefa</button>
                </div>
            </div>
            
            <div class="kanban-board" id="kanbanBoard">
                <div class="kanban-column" data-status="todo">
                    <div class="column-header">
                        <h3>üìù A Fazer</h3>
                        <span class="task-count" id="todoCount">0</span>
                    </div>
                    <div class="column-content" id="todoColumn">
                        <!-- Tarefas A Fazer -->
                    </div>
                </div>
                
                <div class="kanban-column" data-status="in-progress">
                    <div class="column-header">
                        <h3>üîÑ Em Progresso</h3>
                        <span class="task-count" id="inProgressCount">0</span>
                    </div>
                    <div class="column-content" id="inProgressColumn">
                        <!-- Tarefas Em Progresso -->
                    </div>
                </div>
                
                <div class="kanban-column" data-status="review">
                    <div class="column-header">
                        <h3>üëÄ Em Revis√£o</h3>
                        <span class="task-count" id="reviewCount">0</span>
                    </div>
                    <div class="column-content" id="reviewColumn">
                        <!-- Tarefas Em Revis√£o -->
                    </div>
                </div>
                
                <div class="kanban-column" data-status="done">
                    <div class="column-header">
                        <h3>‚úÖ Conclu√≠do</h3>
                        <span class="task-count" id="doneCount">0</span>
                    </div>
                    <div class="column-content" id="doneColumn">
                        <!-- Tarefas Conclu√≠das -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Gantt Tab -->
        <div id="ganttTab" class="tab-content">
            <div class="section-header">
                <h2>üìà Gr√°fico de Gantt</h2>
                <div class="gantt-controls">
                    <select id="ganttProjectFilter" onchange="updateGanttChart()">
                        <option value="">Todos os Projetos</option>
                    </select>
                    <div class="date-range">
                        <input type="date" id="ganttStartDate" onchange="updateGanttChart()">
                        <span>at√©</span>
                        <input type="date" id="ganttEndDate" onchange="updateGanttChart()">
                    </div>
                </div>
            </div>
            
            <div class="gantt-container">
                <div class="gantt-chart" id="ganttChart">
                    <!-- Gr√°fico de Gantt ser√° renderizado aqui -->
                </div>
            </div>
        </div>

        <!-- Tempo Tab -->
        <div id="tempoTab" class="tab-content">
            <div class="section-header">
                <h2>‚è±Ô∏è Controle de Tempo</h2>
                <div class="time-controls">
                    <div class="active-timer" id="activeTimer" style="display: none;">
                        <span>‚è±Ô∏è Trabalhando em: <strong id="currentTask"></strong></span>
                        <span id="timerDisplay">00:00:00</span>
                        <button class="btn btn-danger" onclick="stopTimer()">‚èπÔ∏è Parar</button>
                    </div>
                </div>
            </div>
            
            <div class="time-tracking-grid">
                <div class="time-card">
                    <h3>üìä Resumo Hoje</h3>
                    <div class="time-stats">
                        <div class="time-stat">
                            <span class="time-value" id="todayTotal">0h 0m</span>
                            <span class="time-label">Total Hoje</span>
                        </div>
                        <div class="time-stat">
                            <span class="time-value" id="todayTasks">0</span>
                            <span class="time-label">Tarefas</span>
                        </div>
                    </div>
                </div>
                
                <div class="time-card">
                    <h3>üìà Esta Semana</h3>
                    <div class="time-stats">
                        <div class="time-stat">
                            <span class="time-value" id="weekTotal">0h 0m</span>
                            <span class="time-label">Total Semana</span>
                        </div>
                        <div class="time-stat">
                            <span class="time-value" id="weekAverage">0h 0m</span>
                            <span class="time-label">M√©dia Di√°ria</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="time-entries">
                <h3>üìù Registros de Tempo</h3>
                <div class="time-filters">
                    <input type="date" id="timeFilterDate" onchange="filterTimeEntries()">
                    <select id="timeFilterProject" onchange="filterTimeEntries()">
                        <option value="">Todos os Projetos</option>
                    </select>
                </div>
                <div class="time-entries-list" id="timeEntriesList">
                    <!-- Registros de tempo ser√£o carregados aqui -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para gerenciamento de usu√°rios -->
    <div id="userManagementModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h2 class="modal-title">üë• Gerenciamento de Usu√°rios</h2>
                <button class="close-btn" onclick="closeUserManagementModal()">&times;</button>
            </div>
            
            <div class="controls">
                <button class="btn btn-add" onclick="openAddUserModal()">‚ûï Adicionar Usu√°rio</button>
            </div>
            
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Email</th>
                            <th>Nome</th>
                            <th>Fun√ß√£o</th>
                            <th>Status</th>
                            <th>Data de Cria√ß√£o</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="userManagementTable">
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Modal para adicionar/editar usu√°rio -->
    <div id="addUserModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="addUserModalTitle">Adicionar Usu√°rio</h2>
                <button class="close-btn" onclick="closeAddUserModal()">&times;</button>
            </div>
            <form id="addUserForm" onsubmit="saveUser(event)">
                <input type="hidden" id="editUserId" value="">
                <div class="form-group">
                    <label for="addUserEmail">Email:</label>
                    <input type="email" id="addUserEmail" required placeholder="novo@email.com">
                </div>
                <div class="form-group">
                    <label for="addUserName">Nome:</label>
                    <input type="text" id="addUserName" required placeholder="Nome completo">
                </div>
                <div class="form-group">
                    <label for="addUserRole">Fun√ß√£o:</label>
                    <select id="addUserRole" required>
                        <option value="user">Usu√°rio</option>
                        <option value="supervisor">Supervisor</option>
                        <option value="admin">Administrador</option>
                    </select>
                </div>
                <div class="form-group" id="passwordField">
                    <label for="addUserPassword">Senha:</label>
                    <input type="password" id="addUserPassword" required placeholder="Senha inicial">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-danger" onclick="closeAddUserModal()">Cancelar</button>
                    <button type="submit" class="btn">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para Projetos -->
    <div id="projectModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="projectModalTitle">Novo Projeto</h2>
                <button class="close-btn" onclick="closeProjectModal()">&times;</button>
            </div>
            <form id="projectForm" onsubmit="saveProject(event)">
                <input type="hidden" id="projectId" value="">
                
                <div class="form-group">
                    <label for="projectName">Nome do Projeto:</label>
                    <input type="text" id="projectName" required placeholder="Digite o nome do projeto">
                </div>
                
                <div class="form-group">
                    <label for="projectDescription">Descri√ß√£o:</label>
                    <textarea id="projectDescription" placeholder="Descreva o projeto..."></textarea>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="projectStartDate">Data de In√≠cio:</label>
                        <input type="date" id="projectStartDate" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="projectEndDate">Data de T√©rmino:</label>
                        <input type="date" id="projectEndDate">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="projectManager">Gerente do Projeto:</label>
                        <select id="projectManager" required>
                            <option value="">Selecione um gerente</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="projectPriority">Prioridade:</label>
                        <select id="projectPriority" required>
                            <option value="baixa">Baixa</option>
                            <option value="media">M√©dia</option>
                            <option value="alta">Alta</option>
                            <option value="critica">Cr√≠tica</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="projectTeam">Equipe:</label>
                    <select id="projectTeam" multiple>
                        <!-- Membros da equipe ser√£o carregados aqui -->
                    </select>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeProjectModal()">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Salvar Projeto</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para Tarefas -->
    <div id="taskModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="taskModalTitle">Nova Tarefa</h2>
                <button class="close-btn" onclick="closeTaskModal()">&times;</button>
            </div>
            <form id="taskForm" onsubmit="saveTask(event)">
                <input type="hidden" id="taskId" value="">
                
                <div class="form-group">
                    <label for="taskTitle">T√≠tulo da Tarefa:</label>
                    <input type="text" id="taskTitle" required placeholder="Digite o t√≠tulo da tarefa">
                </div>
                
                <div class="form-group">
                    <label for="taskDescription">Descri√ß√£o:</label>
                    <textarea id="taskDescription" placeholder="Descreva a tarefa..."></textarea>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="taskProject">Projeto:</label>
                        <select id="taskProject" required>
                            <option value="">Selecione um projeto</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="taskAssignee">Respons√°vel:</label>
                        <select id="taskAssignee" required>
                            <option value="">Selecione um respons√°vel</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="taskStatus">Status:</label>
                        <select id="taskStatus" required>
                            <option value="todo">A Fazer</option>
                            <option value="in-progress">Em Progresso</option>
                            <option value="review">Em Revis√£o</option>
                            <option value="done">Conclu√≠do</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="taskPriority">Prioridade:</label>
                        <select id="taskPriority" required>
                            <option value="baixa">Baixa</option>
                            <option value="media">M√©dia</option>
                            <option value="alta">Alta</option>
                            <option value="critica">Cr√≠tica</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="taskStartDate">Data de In√≠cio:</label>
                        <input type="date" id="taskStartDate">
                    </div>
                    
                    <div class="form-group">
                        <label for="taskDueDate">Prazo:</label>
                        <input type="date" id="taskDueDate">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="taskEstimatedHours">Horas Estimadas:</label>
                    <input type="number" id="taskEstimatedHours" min="0" step="0.5" placeholder="Ex: 8">
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeTaskModal()">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Salvar Tarefa</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para Controle de Tempo -->
    <div id="timeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Registrar Tempo</h2>
                <button class="close-btn" onclick="closeTimeModal()">&times;</button>
            </div>
            <form id="timeForm" onsubmit="saveTimeEntry(event)">
                <div class="form-group">
                    <label for="timeTask">Tarefa:</label>
                    <select id="timeTask" required>
                        <option value="">Selecione uma tarefa</option>
                    </select>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="timeDate">Data:</label>
                        <input type="date" id="timeDate" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="timeHours">Horas Trabalhadas:</label>
                        <input type="number" id="timeHours" min="0" step="0.25" required placeholder="Ex: 2.5">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="timeDescription">Descri√ß√£o do Trabalho:</label>
                    <textarea id="timeDescription" placeholder="Descreva o que foi feito..."></textarea>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeTimeModal()">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Registrar Tempo</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Carregar os scripts JavaScript -->
    <script src="js/firebase-config.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/user-management.js"></script>
    <script src="js/projects.js"></script>
    <script src="js/tasks.js"></script>
    <script src="js/kanban.js"></script>
    <script src="js/gantt.js"></script>
    <script src="js/time-tracking.js"></script>
    <script src="js/dashboard.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
